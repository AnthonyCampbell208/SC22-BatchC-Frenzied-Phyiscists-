{"backend_state":"running","connection_file":"/projects/d5a3aa23-997d-4ffc-977a-1dc20c583e62/.local/share/jupyter/runtime/kernel-3450636d-66a2-487e-916e-8e74d9f604e7.json","kernel":"ds_env","kernel_error":"","kernel_state":"idle","kernel_usage":{"cpu":0,"memory":0},"metadata":{"language_info":{"codemirror_mode":{"name":"ipython","version":3},"file_extension":".py","mimetype":"text/x-python","name":"python","nbconvert_exporter":"python","pygments_lexer":"ipython3","version":"3.8.13"}},"trust":true,"type":"settings"}
{"cell_type":"code","end":1659622307562,"exec_count":3,"id":"e9c450","input":"heart_df = pd.read_csv(\"data/heart.csv\")\nheart_df\n","kernel":"ds_env","output":{"0":{"data":{"text/html":"<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>Age</th>\n      <th>Sex</th>\n      <th>ChestPainType</th>\n      <th>RestingBP</th>\n      <th>Cholesterol</th>\n      <th>FastingBS</th>\n      <th>RestingECG</th>\n      <th>MaxHR</th>\n      <th>ExerciseAngina</th>\n      <th>Oldpeak</th>\n      <th>ST_Slope</th>\n      <th>HeartDisease</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>40</td>\n      <td>M</td>\n      <td>ATA</td>\n      <td>140</td>\n      <td>289</td>\n      <td>0</td>\n      <td>Normal</td>\n      <td>172</td>\n      <td>N</td>\n      <td>0.0</td>\n      <td>Up</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>49</td>\n      <td>F</td>\n      <td>NAP</td>\n      <td>160</td>\n      <td>180</td>\n      <td>0</td>\n      <td>Normal</td>\n      <td>156</td>\n      <td>N</td>\n      <td>1.0</td>\n      <td>Flat</td>\n      <td>1</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>37</td>\n      <td>M</td>\n      <td>ATA</td>\n      <td>130</td>\n      <td>283</td>\n      <td>0</td>\n      <td>ST</td>\n      <td>98</td>\n      <td>N</td>\n      <td>0.0</td>\n      <td>Up</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>48</td>\n      <td>F</td>\n      <td>ASY</td>\n      <td>138</td>\n      <td>214</td>\n      <td>0</td>\n      <td>Normal</td>\n      <td>108</td>\n      <td>Y</td>\n      <td>1.5</td>\n      <td>Flat</td>\n      <td>1</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>54</td>\n      <td>M</td>\n      <td>NAP</td>\n      <td>150</td>\n      <td>195</td>\n      <td>0</td>\n      <td>Normal</td>\n      <td>122</td>\n      <td>N</td>\n      <td>0.0</td>\n      <td>Up</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>...</th>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n    </tr>\n    <tr>\n      <th>913</th>\n      <td>45</td>\n      <td>M</td>\n      <td>TA</td>\n      <td>110</td>\n      <td>264</td>\n      <td>0</td>\n      <td>Normal</td>\n      <td>132</td>\n      <td>N</td>\n      <td>1.2</td>\n      <td>Flat</td>\n      <td>1</td>\n    </tr>\n    <tr>\n      <th>914</th>\n      <td>68</td>\n      <td>M</td>\n      <td>ASY</td>\n      <td>144</td>\n      <td>193</td>\n      <td>1</td>\n      <td>Normal</td>\n      <td>141</td>\n      <td>N</td>\n      <td>3.4</td>\n      <td>Flat</td>\n      <td>1</td>\n    </tr>\n    <tr>\n      <th>915</th>\n      <td>57</td>\n      <td>M</td>\n      <td>ASY</td>\n      <td>130</td>\n      <td>131</td>\n      <td>0</td>\n      <td>Normal</td>\n      <td>115</td>\n      <td>Y</td>\n      <td>1.2</td>\n      <td>Flat</td>\n      <td>1</td>\n    </tr>\n    <tr>\n      <th>916</th>\n      <td>57</td>\n      <td>F</td>\n      <td>ATA</td>\n      <td>130</td>\n      <td>236</td>\n      <td>0</td>\n      <td>LVH</td>\n      <td>174</td>\n      <td>N</td>\n      <td>0.0</td>\n      <td>Flat</td>\n      <td>1</td>\n    </tr>\n    <tr>\n      <th>917</th>\n      <td>38</td>\n      <td>M</td>\n      <td>NAP</td>\n      <td>138</td>\n      <td>175</td>\n      <td>0</td>\n      <td>Normal</td>\n      <td>173</td>\n      <td>N</td>\n      <td>0.0</td>\n      <td>Up</td>\n      <td>0</td>\n    </tr>\n  </tbody>\n</table>\n<p>918 rows × 12 columns</p>\n</div>","text/plain":"     Age Sex ChestPainType  RestingBP  Cholesterol  FastingBS RestingECG  \\\n0     40   M           ATA        140          289          0     Normal   \n1     49   F           NAP        160          180          0     Normal   \n2     37   M           ATA        130          283          0         ST   \n3     48   F           ASY        138          214          0     Normal   \n4     54   M           NAP        150          195          0     Normal   \n..   ...  ..           ...        ...          ...        ...        ...   \n913   45   M            TA        110          264          0     Normal   \n914   68   M           ASY        144          193          1     Normal   \n915   57   M           ASY        130          131          0     Normal   \n916   57   F           ATA        130          236          0        LVH   \n917   38   M           NAP        138          175          0     Normal   \n\n     MaxHR ExerciseAngina  Oldpeak ST_Slope  HeartDisease  \n0      172              N      0.0       Up             0  \n1      156              N      1.0     Flat             1  \n2       98              N      0.0       Up             0  \n3      108              Y      1.5     Flat             1  \n4      122              N      0.0       Up             0  \n..     ...            ...      ...      ...           ...  \n913    132              N      1.2     Flat             1  \n914    141              N      3.4     Flat             1  \n915    115              Y      1.2     Flat             1  \n916    174              N      0.0     Flat             1  \n917    173              N      0.0       Up             0  \n\n[918 rows x 12 columns]"},"exec_count":3}},"pos":4,"start":1659622307532,"state":"done","type":"cell"}
{"cell_type":"code","end":1659622307589,"exec_count":4,"id":"4da2e1","input":"#heart_df['female'] = heart_df['female'].map({'F': 1, 'M': 0})\nheart_df['Sex'].replace('F',0 ,inplace=True)\nheart_df['Sex'].replace('M', 1,inplace=True)\n#Female is 0\n#Male is 1\n\n#ATA is 0\n#NAP is 1\n#ASY is 2\n#TA is 3\nheart_df['ChestPainType'].replace('ATA',0 ,inplace=True)\nheart_df['ChestPainType'].replace('NAP',1 ,inplace=True)\nheart_df['ChestPainType'].replace('ASY',2 ,inplace=True)\nheart_df['ChestPainType'].replace('TA',3 ,inplace=True)\n\n#Normal is 0\n#St is 1\n#LVH is 2\nheart_df['RestingECG'].replace('Normal',0, inplace=True)\nheart_df['RestingECG'].replace('ST',1, inplace=True)\nheart_df['RestingECG'].replace('LVH',2, inplace=True)\n\n#No is 0\n#Yes is 1\nheart_df['ExerciseAngina'].replace('N',0 ,inplace=True)\nheart_df['ExerciseAngina'].replace('Y',1 ,inplace=True)\n\n#ST_Slope\n#Up is 0\n#Flat is 1\n#Down is 2\nheart_df['ST_Slope'].replace('Up', 0, inplace = True)\nheart_df['ST_Slope'].replace('Flat', 1, inplace = True)\nheart_df['ST_Slope'].replace('Down', 2, inplace = True)\n\n#My computer just crashed, sorry!\n#np. Anthony is explaining scatter plots right now.\n\nheart_df.head() #worky :)","kernel":"ds_env","output":{"0":{"data":{"text/html":"<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>Age</th>\n      <th>Sex</th>\n      <th>ChestPainType</th>\n      <th>RestingBP</th>\n      <th>Cholesterol</th>\n      <th>FastingBS</th>\n      <th>RestingECG</th>\n      <th>MaxHR</th>\n      <th>ExerciseAngina</th>\n      <th>Oldpeak</th>\n      <th>ST_Slope</th>\n      <th>HeartDisease</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>40</td>\n      <td>1</td>\n      <td>0</td>\n      <td>140</td>\n      <td>289</td>\n      <td>0</td>\n      <td>0</td>\n      <td>172</td>\n      <td>0</td>\n      <td>0.0</td>\n      <td>0</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>49</td>\n      <td>0</td>\n      <td>1</td>\n      <td>160</td>\n      <td>180</td>\n      <td>0</td>\n      <td>0</td>\n      <td>156</td>\n      <td>0</td>\n      <td>1.0</td>\n      <td>1</td>\n      <td>1</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>37</td>\n      <td>1</td>\n      <td>0</td>\n      <td>130</td>\n      <td>283</td>\n      <td>0</td>\n      <td>1</td>\n      <td>98</td>\n      <td>0</td>\n      <td>0.0</td>\n      <td>0</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>48</td>\n      <td>0</td>\n      <td>2</td>\n      <td>138</td>\n      <td>214</td>\n      <td>0</td>\n      <td>0</td>\n      <td>108</td>\n      <td>1</td>\n      <td>1.5</td>\n      <td>1</td>\n      <td>1</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>54</td>\n      <td>1</td>\n      <td>1</td>\n      <td>150</td>\n      <td>195</td>\n      <td>0</td>\n      <td>0</td>\n      <td>122</td>\n      <td>0</td>\n      <td>0.0</td>\n      <td>0</td>\n      <td>0</td>\n    </tr>\n  </tbody>\n</table>\n</div>","text/plain":"   Age  Sex  ChestPainType  RestingBP  Cholesterol  FastingBS  RestingECG  \\\n0   40    1              0        140          289          0           0   \n1   49    0              1        160          180          0           0   \n2   37    1              0        130          283          0           1   \n3   48    0              2        138          214          0           0   \n4   54    1              1        150          195          0           0   \n\n   MaxHR  ExerciseAngina  Oldpeak  ST_Slope  HeartDisease  \n0    172               0      0.0         0             0  \n1    156               0      1.0         1             1  \n2     98               0      0.0         0             0  \n3    108               1      1.5         1             1  \n4    122               0      0.0         0             0  "},"exec_count":4}},"pos":5,"start":1659622307566,"state":"done","type":"cell"}
{"cell_type":"code","end":1659622307602,"exec_count":5,"id":"b486e0","input":"heart_df.dropna(inplace=True)\nheart_df.shape","kernel":"ds_env","output":{"0":{"data":{"text/plain":"(918, 12)"},"exec_count":5}},"pos":6,"start":1659622307595,"state":"done","type":"cell"}
{"cell_type":"code","end":1659622307612,"exec_count":6,"id":"105d6d","input":"scores = {}\nscores['metrics'] = {'accuracy': 'accuracy', 'precision':'precision', 'recall':'recall', 'f1_score':'f1_score'}","kernel":"ds_env","pos":8,"start":1659622307608,"state":"done","type":"cell"}
{"cell_type":"code","end":1659622307632,"exec_count":7,"id":"f0aefb","input":"target = heart_df[\"HeartDisease\"]\ninput_columns = heart_df.loc[:, heart_df.columns != \"HeartDisease\"]\nx_train, x_test, y_train, y_test = train_test_split(input_columns, target, test_size=0.3)\nscaler = StandardScaler()\n\nx_train = scaler.fit_transform(x_train)\nx_test = scaler.transform(x_test)","kernel":"ds_env","pos":9,"start":1659622307629,"state":"done","type":"cell"}
{"cell_type":"code","end":1659622897112,"exec_count":11,"id":"e0b101","input":"import pandas as pd\nimport numpy as np\nimport plotly.express as px\nimport numpy\nimport matplotlib.pyplot as plt\nfrom matplotlib.colors import ListedColormap\nimport seaborn as sns\nimport sklearn\nfrom sklearn.metrics import confusion_matrix\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.neighbors import KNeighborsClassifier as KNN\nfrom sklearn.ensemble import AdaBoostClassifier\nfrom sklearn.metrics import accuracy_score\nfrom sklearn.metrics import recall_score\nfrom sklearn.metrics import precision_score\nfrom sklearn.metrics import f1_score\nfrom sklearn.neural_network import MLPClassifier\nfrom sklearn.preprocessing import StandardScaler\nfrom sklearn.linear_model import LogisticRegression\nfrom sklearn.naive_bayes import GaussianNB\nfrom sklearn import tree\nfrom sklearn.tree import DecisionTreeClassifier\nfrom sklearn.ensemble import RandomForestClassifier as RFC\nimport tensorflow as tf\nfrom sklearn.model_selection import GridSearchCV\nfrom sklearn.model_selection import RandomizedSearchCV\nfrom sklearn.multiclass import OneVsRestClassifier\nfrom sklearn.naive_bayes import GaussianNB\nfrom sklearn.svm import SVC as svc\nfrom sklearn.metrics import confusion_matrix,ConfusionMatrixDisplay\n","kernel":"ds_env","pos":3,"start":1659622897098,"state":"done","type":"cell"}
{"cell_type":"code","end":1659626106664,"exec_count":18,"id":"91d043","input":"# ss=StandardScaler()\n# x_train=ss.fit_transform(x_train)\n# x_test=ss.fit_transform(x_test)\nCNN2 = tf.keras.Sequential()\nCNN2.add(tf.keras.layers.Dense(units=145,activation=\"relu\",input_dim=11))\nCNN2.add(tf.keras.layers.Dense(units=120,activation=\"relu\",  kernel_regularizer=tf.keras.regularizers.l1(0.003)))\nCNN2.add(tf.keras.layers.Dense(units=70,activation=\"relu\",  kernel_regularizer=tf.keras.regularizers.l1(0.003)))\nCNN2.add(tf.keras.layers.Dense(units=50,activation=\"relu\",  kernel_regularizer=tf.keras.regularizers.l1(0.003)))\nCNN2.add(tf.keras.layers.Dense(units=1,activation=\"sigmoid\"))\nCNN2.summary()\nCNN2.compile(optimizer=\"adam\",loss=\"binary_crossentropy\",metrics=[\"accuracy\"])\nCNN2_his=CNN2.fit(x_train,y_train,validation_split=0.30, batch_size=55,epochs=25)\ny_pred=CNN2.predict(x_test)\ny_pred = (y_pred > 0.5)\nsns.heatmap(confusion_matrix(y_test, y_pred), annot=True, fmt='g')\ntest_loss, test_acc = CNN2.evaluate(x_test,  y_test)","kernel":"ds_env","output":{"0":{"name":"stdout","text":"Model: \"sequential_1\"\n"},"1":{"name":"stdout","text":"_________________________________________________________________\n"},"10":{"name":"stdout","text":" dense_8 (Dense)             (None, 50)                3550      \n"},"11":{"name":"stdout","text":"                                                                 \n"},"12":{"name":"stdout","text":" dense_9 (Dense)             (None, 1)                 51        \n"},"13":{"name":"stdout","text":"                                                                 \n"},"14":{"name":"stdout","text":"=================================================================\n"},"15":{"name":"stdout","text":"Total params: 31,331\n"},"16":{"name":"stdout","text":"Trainable params: 31,331\n"},"17":{"name":"stdout","text":"Non-trainable params: 0\n"},"18":{"name":"stdout","text":"_________________________________________________________________\n"},"19":{"name":"stdout","text":"Epoch 1/25\n"},"2":{"name":"stdout","text":" Layer (type)                Output Shape              Param #   \n"},"20":{"name":"stdout","text":"\r1/9 [==>...........................] - ETA: 5s - loss: 8.0585 - accuracy: 0.4545"},"21":{"name":"stdout","text":"\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r9/9 [==============================] - 1s 27ms/step - loss: 7.7387 - accuracy: 0.6459 - val_loss: 7.2772 - val_accuracy: 0.8238\n"},"22":{"name":"stdout","text":"Epoch 2/25\n"},"23":{"name":"stdout","text":"\r1/9 [==>...........................] - ETA: 0s - loss: 7.2677 - accuracy: 0.8182"},"24":{"name":"stdout","text":"\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r9/9 [==============================] - ETA: 0s - loss: 6.9719 - accuracy: 0.8374"},"25":{"name":"stdout","text":"\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r9/9 [==============================] - 0s 21ms/step - loss: 6.9719 - accuracy: 0.8374 - val_loss: 6.5491 - val_accuracy: 0.8187\n"},"26":{"name":"stdout","text":"Epoch 3/25\n"},"27":{"name":"stdout","text":"\r1/9 [==>...........................] - ETA: 0s - loss: 6.5284 - accuracy: 0.9091"},"28":{"name":"stdout","text":"\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r9/9 [==============================] - 0s 10ms/step - loss: 6.2446 - accuracy: 0.8396 - val_loss: 5.8675 - val_accuracy: 0.8187\n"},"29":{"name":"stdout","text":"Epoch 4/25\n"},"3":{"name":"stdout","text":"=================================================================\n"},"30":{"name":"stdout","text":"\r1/9 [==>...........................] - ETA: 0s - loss: 5.8108 - accuracy: 0.8364"},"31":{"name":"stdout","text":"\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r9/9 [==============================] - 0s 7ms/step - loss: 5.5604 - accuracy: 0.8463 - val_loss: 5.2417 - val_accuracy: 0.8290\n"},"32":{"name":"stdout","text":"Epoch 5/25\n"},"33":{"name":"stdout","text":"\r1/9 [==>...........................] - ETA: 0s - loss: 5.2982 - accuracy: 0.8000"},"34":{"name":"stdout","text":"\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r9/9 [==============================] - 0s 7ms/step - loss: 4.9405 - accuracy: 0.8664 - val_loss: 4.6822 - val_accuracy: 0.8290\n"},"35":{"name":"stdout","text":"Epoch 6/25\n"},"36":{"name":"stdout","text":"\r1/9 [==>...........................] - ETA: 0s - loss: 4.5741 - accuracy: 0.8545"},"37":{"name":"stdout","text":"\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r9/9 [==============================] - 0s 6ms/step - loss: 4.3868 - accuracy: 0.8753 - val_loss: 4.1639 - val_accuracy: 0.8342\n"},"38":{"name":"stdout","text":"Epoch 7/25\n"},"39":{"name":"stdout","text":"\r1/9 [==>...........................] - ETA: 0s - loss: 3.9896 - accuracy: 0.9091"},"4":{"name":"stdout","text":" dense_5 (Dense)             (None, 145)               1740      \n"},"40":{"name":"stdout","text":"\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r9/9 [==============================] - 0s 6ms/step - loss: 3.8743 - accuracy: 0.8820 - val_loss: 3.6758 - val_accuracy: 0.8290\n"},"41":{"name":"stdout","text":"Epoch 8/25\n"},"42":{"name":"stdout","text":"\r1/9 [==>...........................] - ETA: 0s - loss: 3.6217 - accuracy: 0.8545"},"43":{"name":"stdout","text":"\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r9/9 [==============================] - 0s 6ms/step - loss: 3.4056 - accuracy: 0.8842 - val_loss: 3.2241 - val_accuracy: 0.8290\n"},"44":{"name":"stdout","text":"Epoch 9/25\n"},"45":{"name":"stdout","text":"\r1/9 [==>...........................] - ETA: 0s - loss: 3.0596 - accuracy: 0.9273"},"46":{"name":"stdout","text":"\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r9/9 [==============================] - 0s 8ms/step - loss: 2.9735 - accuracy: 0.8864 - val_loss: 2.8211 - val_accuracy: 0.8290\n"},"47":{"name":"stdout","text":"Epoch 10/25\n"},"48":{"name":"stdout","text":"\r1/9 [==>...........................] - ETA: 0s - loss: 2.7358 - accuracy: 0.8909"},"49":{"name":"stdout","text":"\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r9/9 [==============================] - 0s 6ms/step - loss: 2.5826 - accuracy: 0.8864 - val_loss: 2.4518 - val_accuracy: 0.8290\n"},"5":{"name":"stdout","text":"                                                                 \n"},"50":{"name":"stdout","text":"Epoch 11/25\n"},"51":{"name":"stdout","text":"\r1/9 [==>...........................] - ETA: 0s - loss: 2.3301 - accuracy: 0.9091"},"52":{"name":"stdout","text":"\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r9/9 [==============================] - 0s 7ms/step - loss: 2.2276 - accuracy: 0.8886 - val_loss: 2.1208 - val_accuracy: 0.8342\n"},"53":{"name":"stdout","text":"Epoch 12/25\n"},"54":{"name":"stdout","text":"\r1/9 [==>...........................] - ETA: 0s - loss: 2.0324 - accuracy: 0.9091"},"55":{"name":"stdout","text":"\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r9/9 [==============================] - 0s 9ms/step - loss: 1.9117 - accuracy: 0.8842 - val_loss: 1.8280 - val_accuracy: 0.8394\n"},"56":{"name":"stdout","text":"Epoch 13/25\n"},"57":{"name":"stdout","text":"\r1/9 [==>...........................] - ETA: 0s - loss: 1.7141 - accuracy: 0.9091"},"58":{"name":"stdout","text":"\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r9/9 [==============================] - 0s 6ms/step - loss: 1.6303 - accuracy: 0.8842 - val_loss: 1.5746 - val_accuracy: 0.8394\n"},"59":{"name":"stdout","text":"Epoch 14/25\n"},"6":{"name":"stdout","text":" dense_6 (Dense)             (None, 120)               17520     \n"},"60":{"name":"stdout","text":"\r1/9 [==>...........................] - ETA: 0s - loss: 1.5234 - accuracy: 0.8727"},"61":{"name":"stdout","text":"\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r9/9 [==============================] - 0s 7ms/step - loss: 1.3919 - accuracy: 0.8909 - val_loss: 1.3622 - val_accuracy: 0.8394\n"},"62":{"name":"stdout","text":"Epoch 15/25\n"},"63":{"name":"stdout","text":"\r1/9 [==>...........................] - ETA: 0s - loss: 1.1757 - accuracy: 0.9091"},"64":{"name":"stdout","text":"\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r9/9 [==============================] - 0s 8ms/step - loss: 1.1862 - accuracy: 0.8886 - val_loss: 1.1734 - val_accuracy: 0.8394\n"},"65":{"name":"stdout","text":"Epoch 16/25\n"},"66":{"name":"stdout","text":"\r1/9 [==>...........................] - ETA: 0s - loss: 1.0819 - accuracy: 0.8727"},"67":{"name":"stdout","text":"\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r9/9 [==============================] - 0s 7ms/step - loss: 1.0200 - accuracy: 0.8842 - val_loss: 1.0337 - val_accuracy: 0.8394\n"},"68":{"name":"stdout","text":"Epoch 17/25\n"},"69":{"name":"stdout","text":"\r1/9 [==>...........................] - ETA: 0s - loss: 0.8696 - accuracy: 0.9273"},"7":{"name":"stdout","text":"                                                                 \n"},"70":{"name":"stdout","text":"\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r9/9 [==============================] - 0s 8ms/step - loss: 0.8888 - accuracy: 0.8864 - val_loss: 0.9265 - val_accuracy: 0.8394\n"},"71":{"name":"stdout","text":"Epoch 18/25\n"},"72":{"name":"stdout","text":"\r1/9 [==>...........................] - ETA: 0s - loss: 0.7238 - accuracy: 0.9455"},"73":{"name":"stdout","text":"\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r9/9 [==============================] - 0s 6ms/step - loss: 0.7899 - accuracy: 0.8909 - val_loss: 0.8441 - val_accuracy: 0.8446\n"},"74":{"name":"stdout","text":"Epoch 19/25\n"},"75":{"name":"stdout","text":"\r1/9 [==>...........................] - ETA: 0s - loss: 0.6456 - accuracy: 0.9091"},"76":{"name":"stdout","text":"\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r9/9 [==============================] - 0s 9ms/step - loss: 0.7152 - accuracy: 0.8909 - val_loss: 0.7839 - val_accuracy: 0.8446\n"},"77":{"name":"stdout","text":"Epoch 20/25\n"},"78":{"name":"stdout","text":"\r1/9 [==>...........................] - ETA: 0s - loss: 0.7452 - accuracy: 0.8545"},"79":{"name":"stdout","text":"\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r9/9 [==============================] - 0s 8ms/step - loss: 0.6579 - accuracy: 0.8931 - val_loss: 0.7408 - val_accuracy: 0.8342\n"},"8":{"name":"stdout","text":" dense_7 (Dense)             (None, 70)                8470      \n"},"80":{"name":"stdout","text":"Epoch 21/25\n"},"81":{"name":"stdout","text":"\r1/9 [==>...........................] - ETA: 0s - loss: 0.5914 - accuracy: 0.9091"},"82":{"name":"stdout","text":"\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r9/9 [==============================] - 0s 7ms/step - loss: 0.6139 - accuracy: 0.8931 - val_loss: 0.6971 - val_accuracy: 0.8446\n"},"83":{"name":"stdout","text":"Epoch 22/25\n"},"84":{"name":"stdout","text":"\r1/9 [==>...........................] - ETA: 0s - loss: 0.6000 - accuracy: 0.8909"},"85":{"name":"stdout","text":"\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r9/9 [==============================] - 0s 6ms/step - loss: 0.5809 - accuracy: 0.8976 - val_loss: 0.6721 - val_accuracy: 0.8446\n"},"86":{"name":"stdout","text":"Epoch 23/25\n"},"87":{"name":"stdout","text":"\r1/9 [==>...........................] - ETA: 0s - loss: 0.6697 - accuracy: 0.8364"},"88":{"name":"stdout","text":"\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r9/9 [==============================] - 0s 7ms/step - loss: 0.5555 - accuracy: 0.8976 - val_loss: 0.6498 - val_accuracy: 0.8497\n"},"89":{"name":"stdout","text":"Epoch 24/25\n"},"9":{"name":"stdout","text":"                                                                 \n"},"90":{"name":"stdout","text":"\r1/9 [==>...........................] - ETA: 0s - loss: 0.5296 - accuracy: 0.8727"},"91":{"name":"stdout","text":"\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r9/9 [==============================] - 0s 8ms/step - loss: 0.5315 - accuracy: 0.8998 - val_loss: 0.6335 - val_accuracy: 0.8446\n"},"92":{"name":"stdout","text":"Epoch 25/25\n"},"93":{"name":"stdout","text":"\r1/9 [==>...........................] - ETA: 0s - loss: 0.4820 - accuracy: 0.9091"},"94":{"name":"stdout","text":"\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r9/9 [==============================] - 0s 15ms/step - loss: 0.5141 - accuracy: 0.8998 - val_loss: 0.6148 - val_accuracy: 0.8497\n"},"95":{"name":"stdout","text":"\r1/9 [==>...........................] - ETA: 0s"},"96":{"name":"stdout","text":"\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r9/9 [==============================] - 0s 2ms/step\n"},"97":{"name":"stdout","text":"\r1/9 [==>...........................] - ETA: 0s - loss: 0.4604 - accuracy: 0.9375"},"98":{"name":"stdout","text":"\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r9/9 [==============================] - 0s 2ms/step - loss: 0.6172 - accuracy: 0.8478\n"},"99":{"data":{"image/png":"19cfee95844ef5093669dc08fd238f80a69e53b1","text/plain":"<Figure size 432x288 with 2 Axes>"},"metadata":{"needs_background":"light"}}},"pos":18,"start":1659626103392,"state":"done","type":"cell"}
{"cell_type":"code","end":1659626132136,"exec_count":20,"id":"14ee11","input":"acc = accuracy_score(y_test, y_pred)\nprec = precision_score(y_test, y_pred)\nrecall = recall_score(y_test, y_pred)\nf1 = f1_score(y_test, y_pred)\nprint(acc, prec, recall, f1)\nscores['CNN'] = {'accuracy': acc, 'precision':prec, 'recall':recall, 'f1_score':f1}\nprint(scores['CNN'])\n\ntitle = \"NN Confusion Matrix\"\nfig, ax = plt.subplots(figsize=(10, 10))\ncm = confusion_matrix(y_test, y_pred, labels=abc.classes_)\ndisp = ConfusionMatrixDisplay(confusion_matrix=cm, display_labels=abc.classes_)\ndisp.plot(ax=ax)\ndisp.ax_.set_title(title)\nfig.savefig(\"confusion_matrices/nn.jpg\")","kernel":"ds_env","output":{"0":{"name":"stdout","text":"0.8478260869565217 0.8291139240506329 0.8972602739726028 0.8618421052631579\n{'accuracy': 0.8478260869565217, 'precision': 0.8291139240506329, 'recall': 0.8972602739726028, 'f1_score': 0.8618421052631579}\n"},"1":{"data":{"image/png":"e5377ff98de0b59850c378598f8c2218cd48e8b2","text/plain":"<Figure size 720x720 with 2 Axes>"},"metadata":{"needs_background":"light"}}},"pos":20,"start":1659626131875,"state":"done","type":"cell"}
{"cell_type":"code","end":1659626231099,"exec_count":21,"id":"d703cc","input":"\nknn = KNN()\nknn.fit(x_train, y_train)\ny_predictions = knn.predict(x_test)\n\nacc = accuracy_score(y_test, y_predictions)\nprec = precision_score(y_test, y_predictions)\nrecall = recall_score(y_test, y_predictions)\nf1 = f1_score(y_test, y_predictions)\nscores['knn'] = {'accuracy': acc, 'precision':prec, 'recall':recall, 'f1_score':f1}\nprint(scores['knn'])\ntitle = \"KNN Confusion Matrix\"\nfig, ax = plt.subplots(figsize=(10, 10))\ncm = confusion_matrix(y_test, y_predictions, labels=abc.classes_)\ndisp = ConfusionMatrixDisplay(confusion_matrix=cm, display_labels=abc.classes_)\ndisp.plot(ax=ax)\ndisp.ax_.set_title(title)\nfig.savefig(\"confusion_matrices/knn.jpg\")","kernel":"ds_env","output":{"0":{"name":"stdout","text":"{'accuracy': 0.8586956521739131, 'precision': 0.8407643312101911, 'recall': 0.9041095890410958, 'f1_score': 0.8712871287128713}\n"},"1":{"data":{"image/png":"78066089c9631dd139beb4e4db87533e02e98bd6","text/plain":"<Figure size 720x720 with 2 Axes>"},"metadata":{"needs_background":"light"}}},"pos":11,"start":1659626230720,"state":"done","type":"cell"}
{"cell_type":"code","end":1659626273343,"exec_count":22,"id":"682a63","input":"#ADABOOST\n# parameters = {'n_estimators':[50, 100, 125, 150], 'learning_rate': [0.01, 0.1, 0.3, 0.5]}\n# scoring = ['precision', 'accuracy', 'recall', 'f1']\n\n\n# for score in scoring:\n#     abc = AdaBoostClassifier()\n#     grid_abc = GridSearchCV(abc, parameters, scoring=score)\n#     grid_abc.fit(x_train, y_train)\n\n\n#     print(\"best params for %s: \" % score)\n#     print(grid_abc.best_params_)\n\n#     means = grid_abc.cv_results_[\"mean_test_score\"]\n\n#     print(\"mean scores\")\n#     for mean, params in zip(means, grid_abc.cv_results_[\"params\"]):\n#         print(\"%0.5f for %r\" % (mean, params))\n\nabc = AdaBoostClassifier(n_estimators=100, learning_rate=0.1)\nabc.fit(x_train, y_train)\n\ny_predictions = abc.predict(x_test)\n\ntotal_squared_error = (np.sum((y_test - y_predictions)**2)) #get the sum of all the errors (error = what we want (y_test) - what we predicted (y_hat))\nmean_squared_error = total_squared_error/len(y_test) #divide this by how many rows/observations we have \n#print(mean_squared_error)\n\ntitle = \"ABC Confusion Matrix\"\nfig, ax = plt.subplots(figsize=(10, 10))\ncm = confusion_matrix(y_test, y_predictions, labels=abc.classes_)\ndisp = ConfusionMatrixDisplay(confusion_matrix=cm, display_labels=abc.classes_)\ndisp.plot(ax=ax)\ndisp.ax_.set_title(title)\nfig.savefig(\"confusion_matrices/abc.jpg\")\n\n# sns.heatmap(confusion_matrix(y_test, y_predictions), annot=True, fmt='g')\nacc = accuracy_score(y_test, y_predictions)\nprec = precision_score(y_test, y_predictions)\nrecall = recall_score(y_test, y_predictions)\nf1 = f1_score(y_test, y_predictions)\nscores['Adaboost'] = {'accuracy': acc, 'precision':prec, 'recall':recall, 'f1_score':f1}\nprint(scores['Adaboost'])\n\n","kernel":"ds_env","output":{"0":{"name":"stdout","text":"{'accuracy': 0.8586956521739131, 'precision': 0.8543046357615894, 'recall': 0.8835616438356164, 'f1_score': 0.8686868686868687}\n"},"1":{"data":{"image/png":"7600cbd155c53116ded277027370173d9ef8017f","text/plain":"<Figure size 720x720 with 2 Axes>"},"metadata":{"needs_background":"light"}}},"pos":10,"start":1659626272882,"state":"done","type":"cell"}
{"cell_type":"code","end":1659626321732,"exec_count":23,"id":"4bc80f","input":"x_train, x_test, y_train, y_test = train_test_split(input_columns, target, test_size=0.3, stratify = y)\nscaler = StandardScaler()\n\nx_train = scaler.fit_transform(x_train)\nx_test = scaler.transform(x_test)\ngnb = GaussianNB(priors=None, var_smoothing=1e-06)\n#fit object model\ngnb.fit(x_train, y_train)\n# GaussianNB(priors=None, var_smoothing= 1)\ny_pred = gnb.predict(x_test)\n#print(\"Naive Bayes score: \",gnb.score(X_test, y_test))#\n#print(\"Number of mislabeled points out of a total %d points : %d\"\n\n\nacc = accuracy_score(y_test, y_pred)\nprec = precision_score(y_test, y_pred)\nrecall = recall_score(y_test, y_pred)\nf1 = f1_score(y_test, y_pred)\nsns.heatmap(confusion_matrix(y_test, y_pred), annot=True, fmt='g')\nscores['NAIVEBAYES'] = {'accuracy': acc, 'precision':prec, 'recall':recall, 'f1_score':f1}\nprint(scores['NAIVEBAYES'])\nprint(\"Naive Bayes score: \",gnb.score(x_test, y_test))","kernel":"ds_env","output":{"0":{"ename":"NameError","evalue":"name 'y' is not defined","traceback":["\u001b[0;31m---------------------------------------------------------------------------\u001b[0m","\u001b[0;31mNameError\u001b[0m                                 Traceback (most recent call last)","Input \u001b[0;32mIn [23]\u001b[0m, in \u001b[0;36m<cell line: 1>\u001b[0;34m()\u001b[0m\n\u001b[0;32m----> 1\u001b[0m x_train, x_test, y_train, y_test \u001b[38;5;241m=\u001b[39m train_test_split(input_columns, target, test_size\u001b[38;5;241m=\u001b[39m\u001b[38;5;241m0.3\u001b[39m, stratify \u001b[38;5;241m=\u001b[39m \u001b[43my\u001b[49m)\n\u001b[1;32m      2\u001b[0m scaler \u001b[38;5;241m=\u001b[39m StandardScaler()\n\u001b[1;32m      4\u001b[0m x_train \u001b[38;5;241m=\u001b[39m scaler\u001b[38;5;241m.\u001b[39mfit_transform(x_train)\n","\u001b[0;31mNameError\u001b[0m: name 'y' is not defined"]}},"pos":36,"start":1659626321663,"state":"done","type":"cell"}
{"cell_type":"code","exec_count":0,"id":"0cad96","input":"param_grid = {'n_estimators': range(1, 101), 'max_depth': range(1, 101)}\ngs = RandomizedSearchCV(RFC(),param_grid)\ngs.fit(x_train, y_train)\n","output":{"0":{"data":{"text/html":"<style>#sk-container-id-30 {color: black;background-color: white;}#sk-container-id-30 pre{padding: 0;}#sk-container-id-30 div.sk-toggleable {background-color: white;}#sk-container-id-30 label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-container-id-30 label.sk-toggleable__label-arrow:before {content: \"▸\";float: left;margin-right: 0.25em;color: #696969;}#sk-container-id-30 label.sk-toggleable__label-arrow:hover:before {color: black;}#sk-container-id-30 div.sk-estimator:hover label.sk-toggleable__label-arrow:before {color: black;}#sk-container-id-30 div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-container-id-30 div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-container-id-30 input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-container-id-30 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {content: \"▾\";}#sk-container-id-30 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-30 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-30 input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-container-id-30 div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-container-id-30 div.sk-estimator:hover {background-color: #d4ebff;}#sk-container-id-30 div.sk-parallel-item::after {content: \"\";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-container-id-30 div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-30 div.sk-serial::before {content: \"\";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: 0;}#sk-container-id-30 div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;position: relative;}#sk-container-id-30 div.sk-item {position: relative;z-index: 1;}#sk-container-id-30 div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;position: relative;}#sk-container-id-30 div.sk-item::before, #sk-container-id-30 div.sk-parallel-item::before {content: \"\";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: -1;}#sk-container-id-30 div.sk-parallel-item {display: flex;flex-direction: column;z-index: 1;position: relative;background-color: white;}#sk-container-id-30 div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-container-id-30 div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-container-id-30 div.sk-parallel-item:only-child::after {width: 0;}#sk-container-id-30 div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;}#sk-container-id-30 div.sk-label label {font-family: monospace;font-weight: bold;display: inline-block;line-height: 1.2em;}#sk-container-id-30 div.sk-label-container {text-align: center;}#sk-container-id-30 div.sk-container {/* jupyter's `normalize.less` sets `[hidden] { display: none; }` but bootstrap.min.css set `[hidden] { display: none !important; }` so we also need the `!important` here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: https://github.com/scikit-learn/scikit-learn/issues/21755 */display: inline-block !important;position: relative;}#sk-container-id-30 div.sk-text-repr-fallback {display: none;}</style><div id=\"sk-container-id-30\" class=\"sk-top-container\"><div class=\"sk-text-repr-fallback\"><pre>RandomizedSearchCV(estimator=RandomForestClassifier(),\n                   param_distributions={&#x27;max_depth&#x27;: range(1, 101),\n                                        &#x27;n_estimators&#x27;: range(1, 101)})</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br />On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class=\"sk-container\" hidden><div class=\"sk-item sk-dashed-wrapped\"><div class=\"sk-label-container\"><div class=\"sk-label sk-toggleable\"><input class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-62\" type=\"checkbox\" ><label for=\"sk-estimator-id-62\" class=\"sk-toggleable__label sk-toggleable__label-arrow\">RandomizedSearchCV</label><div class=\"sk-toggleable__content\"><pre>RandomizedSearchCV(estimator=RandomForestClassifier(),\n                   param_distributions={&#x27;max_depth&#x27;: range(1, 101),\n                                        &#x27;n_estimators&#x27;: range(1, 101)})</pre></div></div></div><div class=\"sk-parallel\"><div class=\"sk-parallel-item\"><div class=\"sk-item\"><div class=\"sk-label-container\"><div class=\"sk-label sk-toggleable\"><input class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-63\" type=\"checkbox\" ><label for=\"sk-estimator-id-63\" class=\"sk-toggleable__label sk-toggleable__label-arrow\">estimator: RandomForestClassifier</label><div class=\"sk-toggleable__content\"><pre>RandomForestClassifier()</pre></div></div></div><div class=\"sk-serial\"><div class=\"sk-item\"><div class=\"sk-estimator sk-toggleable\"><input class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-64\" type=\"checkbox\" ><label for=\"sk-estimator-id-64\" class=\"sk-toggleable__label sk-toggleable__label-arrow\">RandomForestClassifier</label><div class=\"sk-toggleable__content\"><pre>RandomForestClassifier()</pre></div></div></div></div></div></div></div></div></div></div>","text/plain":"RandomizedSearchCV(estimator=RandomForestClassifier(),\n                   param_distributions={'max_depth': range(1, 101),\n                                        'n_estimators': range(1, 101)})"},"exec_count":0,"output_type":"execute_result"}},"pos":44,"scrolled":true,"type":"cell"}
{"cell_type":"code","exec_count":0,"id":"2acf32","input":"","pos":26,"type":"cell"}
{"cell_type":"code","exec_count":0,"id":"6be781","input":"","pos":24,"type":"cell"}
{"cell_type":"code","exec_count":124,"id":"018aad","input":"gs.best_estimator_","output":{"0":{"data":{"text/html":"<style>#sk-container-id-55 {color: black;background-color: white;}#sk-container-id-55 pre{padding: 0;}#sk-container-id-55 div.sk-toggleable {background-color: white;}#sk-container-id-55 label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-container-id-55 label.sk-toggleable__label-arrow:before {content: \"▸\";float: left;margin-right: 0.25em;color: #696969;}#sk-container-id-55 label.sk-toggleable__label-arrow:hover:before {color: black;}#sk-container-id-55 div.sk-estimator:hover label.sk-toggleable__label-arrow:before {color: black;}#sk-container-id-55 div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-container-id-55 div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-container-id-55 input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-container-id-55 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {content: \"▾\";}#sk-container-id-55 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-55 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-55 input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-container-id-55 div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-container-id-55 div.sk-estimator:hover {background-color: #d4ebff;}#sk-container-id-55 div.sk-parallel-item::after {content: \"\";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-container-id-55 div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-55 div.sk-serial::before {content: \"\";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: 0;}#sk-container-id-55 div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;position: relative;}#sk-container-id-55 div.sk-item {position: relative;z-index: 1;}#sk-container-id-55 div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;position: relative;}#sk-container-id-55 div.sk-item::before, #sk-container-id-55 div.sk-parallel-item::before {content: \"\";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: -1;}#sk-container-id-55 div.sk-parallel-item {display: flex;flex-direction: column;z-index: 1;position: relative;background-color: white;}#sk-container-id-55 div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-container-id-55 div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-container-id-55 div.sk-parallel-item:only-child::after {width: 0;}#sk-container-id-55 div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;}#sk-container-id-55 div.sk-label label {font-family: monospace;font-weight: bold;display: inline-block;line-height: 1.2em;}#sk-container-id-55 div.sk-label-container {text-align: center;}#sk-container-id-55 div.sk-container {/* jupyter's `normalize.less` sets `[hidden] { display: none; }` but bootstrap.min.css set `[hidden] { display: none !important; }` so we also need the `!important` here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: https://github.com/scikit-learn/scikit-learn/issues/21755 */display: inline-block !important;position: relative;}#sk-container-id-55 div.sk-text-repr-fallback {display: none;}</style><div id=\"sk-container-id-55\" class=\"sk-top-container\"><div class=\"sk-text-repr-fallback\"><pre>DecisionTreeClassifier(max_depth=54, min_samples_leaf=11, min_samples_split=33)</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br />On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class=\"sk-container\" hidden><div class=\"sk-item\"><div class=\"sk-estimator sk-toggleable\"><input class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-109\" type=\"checkbox\" checked><label for=\"sk-estimator-id-109\" class=\"sk-toggleable__label sk-toggleable__label-arrow\">DecisionTreeClassifier</label><div class=\"sk-toggleable__content\"><pre>DecisionTreeClassifier(max_depth=54, min_samples_leaf=11, min_samples_split=33)</pre></div></div></div></div></div>","text/plain":"DecisionTreeClassifier(max_depth=54, min_samples_leaf=11, min_samples_split=33)"},"exec_count":124,"output_type":"execute_result"}},"pos":33,"type":"cell"}
{"cell_type":"code","exec_count":125,"id":"7cec8f","input":"gs.best_score_","output":{"0":{"data":{"text/plain":"0.8542260739912402"},"exec_count":125,"output_type":"execute_result"}},"pos":34,"type":"cell"}
{"cell_type":"code","exec_count":127,"id":"020f70","input":"sns.heatmap(confusion_matrix(y_test, y_hat), annot=True, fmt='g')","output":{"0":{"data":{"text/plain":"<AxesSubplot:>"},"exec_count":127,"output_type":"execute_result"},"1":{"data":{"image/png":"be065a5158aecbbe6216372a0091ac139f4eaa08","text/plain":"<Figure size 432x288 with 2 Axes>"},"exec_count":127,"metadata":{"needs_background":"light"},"output_type":"execute_result"}},"pos":29,"type":"cell"}
{"cell_type":"code","exec_count":13,"id":"29e78b","input":"param_grid = {'n_neighbors': range(1, 400)}\n\nx = KNN()\ngrid_x = GridSearchCV(x, param_grid)\ngrid_x.fit(x_train, y_train)\nprint(grid_x.best_params_)\n\nbest_knn = grid_x.best_estimator_\ny_predictions = best_knn.predict(x_test)\n\nacc = accuracy_score(y_test, y_predictions)\nprec = precision_score(y_test, y_predictions)\nrecall = recall_score(y_test, y_predictions)\nf1 = f1_score(y_test, y_predictions)\nscores['knn_grid'] = {'accuracy': acc, 'precision':prec, 'recall':recall, 'f1_score':f1}\nprint(scores['knn_grid'])","output":{"0":{"name":"stdout","output_type":"stream","text":"{'n_neighbors': 47}\n{'accuracy': 0.8623188405797102, 'precision': 0.8866666666666667, 'recall': 0.8636363636363636, 'f1_score': 0.875}\n"}},"pos":12,"type":"cell"}
{"cell_type":"code","exec_count":17,"id":"429a7d","input":"#x is everything but heart disease\nlr_clf = LogisticRegression(random_state=42)\n#Fits dataset\nlr_clf.fit(x_train, y_train)\n#gets predicted values\ny_pred= lr_clf.predict(x_test)\n#compares predictions to actual values\n# sns.heatmap(confusion_matrix(y_test, y_pred), annot=True, fmt='g')\n\nacc = accuracy_score(y_test, y_pred)\nprec = precision_score(y_test, y_pred)\nrecall = recall_score(y_test, y_pred)\nf1 = f1_score(y_test, y_pred)\n# fig = sns.heatmap(confusion_matrix(y_test, y_pred), annot=True, fmt='g').get_figure()\n# fig.savefig(\"lr_cm.png\") \n\ntitle = \"Logistic Regression Confusion Matrix\"\nfig, ax = plt.subplots(figsize=(10, 10))\ncm = confusion_matrix(y_test, y_pred, labels=abc.classes_)\ndisp = ConfusionMatrixDisplay(confusion_matrix=cm, display_labels=abc.classes_)\ndisp.plot(ax=ax)\ndisp.ax_.set_title(title)\nfig.savefig(\"confusion_matrices/lr.jpg\")\n\nscores['LOGISTICREGRESSION'] = {'accuracy': acc, 'precision':prec, 'recall':recall, 'f1_score':f1}\nprint(scores['LOGISTICREGRESSION'])\n\n","kernel":"ds_env","output":{"0":{"name":"stdout","text":"{'accuracy': 0.8405797101449275, 'precision': 0.84, 'recall': 0.863013698630137, 'f1_score': 0.8513513513513513}\n"},"1":{"data":{"image/png":"6d03ea0ff8a409f049ede856890dd0d47b50a380","text/plain":"<Figure size 432x288 with 2 Axes>"},"metadata":{"needs_background":"light"}},"2":{"data":{"image/png":"55e2b53d5d95646fb1823bb36395662be81ebb30","text/plain":"<Figure size 720x720 with 2 Axes>"},"metadata":{"needs_background":"light"}}},"pos":13,"state":"done","type":"cell"}
{"cell_type":"code","exec_count":17,"id":"d568ca","input":"scores.keys()","output":{"0":{"data":{"text/plain":"dict_keys(['metrics', 'Adaboost', 'knn_grid', 'knn', 'LOGISTICREGRESSION'])"},"exec_count":17,"output_type":"execute_result"}},"pos":14,"type":"cell"}
{"cell_type":"code","exec_count":176,"id":"e6da3c","input":"acc = accuracy_score(y_test, y_hat)\nprec = precision_score(y_test, y_hat)\nrecall = recall_score(y_test, y_hat)\nf1 = f1_score(y_test, y_hat)\nprint(acc, prec, recall, f1)\nscores['RFC'] = {'accuracy': acc, 'precision':prec, 'recall':recall, 'f1_score':f1}\nprint(scores['RFC'])","output":{"0":{"name":"stdout","output_type":"stream","text":"0.8913043478260869 0.9316239316239316 0.9008264462809917 0.9159663865546218\n{'accuracy': 0.8913043478260869, 'precision': 0.9316239316239316, 'recall': 0.9008264462809917, 'f1_score': 0.9159663865546218}\n"}},"pos":43,"type":"cell"}
{"cell_type":"code","exec_count":179,"id":"01c528","input":"gs.best_params_","output":{"0":{"data":{"text/plain":"{'n_estimators': 67, 'max_depth': 90}"},"exec_count":179,"output_type":"execute_result"}},"pos":45,"type":"cell"}
{"cell_type":"code","exec_count":18,"id":"0ceccc","input":"mlp = MLPClassifier(solver='lbfgs',hidden_layer_sizes=(1000, 35), alpha=0.05, max_iter=200, random_state = 1, activation='relu', learning_rate='adaptive')\nmlp.fit(x_train, y_train)\ny_hat = mlp.predict(x_test)\nprint(y_hat)\nprint(np.array(y_test))\ntotal_squared_error = (np.sum((y_test - y_hat)**2)) #get the sum of all the errors (error = what we want (y_test) - what we predicted (y_hat))\nmean_squared_error = total_squared_error/len(y_test) #divide this by how many rows/observations we have \nprint(mean_squared_error)\nsns.heatmap(confusion_matrix(y_test, y_hat), annot=True, fmt='g')\nacc = accuracy_score(y_test, y_hat)\nprec = precision_score(y_test, y_hat, average='micro')\nrecall = recall_score(y_test, y_hat, average='micro')\nf1 = f1_score(y_test, y_hat, average='micro')\nscores['mlp'] = {'accuracy': acc, 'precision':prec, 'recall':recall, 'f1_score':f1}\nprint(scores['mlp'])","output":{"0":{"name":"stdout","output_type":"stream","text":"[0 1 1 0 1 1 1 1 1 0 1 1 0 0 0 1 1 1 1 1 0 1 1 1 1 1 1 1 1 0 0 1 1 0 1 1 0\n 1 1 0 0 1 1 0 1 0 0 0 0 0 1 1 1 1 1 1 0 1 0 0 0 0 0 0 0 1 1 1 0 0 1 1 1 1\n 1 0 0 1 0 1 1 1 1 1 1 0 0 0 0 1 0 0 0 0 1 0 1 1 1 1 1 1 0 1 0 1 0 0 0 1 0\n 1 0 1 1 0 1 0 1 1 1 1 0 1 1 0 0 1 0 0 0 1 1 0 0 0 0 1 1 0 1 1 1 1 0 1 0 0\n 0 0 0 1 0 0 1 1 0 1 0 0 1 0 0 1 0 0 0 1 0 1 1 0 0 1 0 0 0 1 0 0 1 0 1 1 0\n 0 1 1 0 1 1 0 1 0 0 1 1 0 0 1 0 0 0 0 1 1 1 0 1 1 0 1 1 0 1 1 1 0 1 1 0 0\n 0 1 0 1 1 1 0 1 1 1 1 1 1 1 0 1 1 1 1 1 1 1 0 1 0 0 0 1 1 1 1 0 0 0 1 0 0\n 0 0 0 1 0 0 1 0 0 1 1 1 0 1 0 1 0]\n[1 1 1 0 1 1 1 0 0 1 1 0 0 0 1 1 1 1 1 1 0 1 1 1 0 1 1 1 0 0 0 1 1 0 1 1 0\n 1 1 0 0 1 1 0 1 0 0 0 0 0 1 1 1 1 1 1 0 1 0 0 0 1 0 0 0 1 1 1 1 0 1 1 1 1\n 1 0 0 1 0 0 1 1 1 1 0 0 1 0 1 1 0 0 0 1 1 0 1 1 1 0 1 0 0 1 0 1 0 0 0 1 1\n 1 0 1 0 0 1 0 1 1 1 1 0 1 1 1 1 1 1 0 0 0 1 0 0 0 0 1 1 0 1 1 1 1 0 1 0 0\n 0 1 0 1 0 0 1 1 0 1 0 0 1 0 1 1 1 0 0 1 0 1 1 0 0 1 0 0 0 1 0 1 1 1 1 1 1\n 0 1 1 0 1 1 0 1 0 0 1 0 0 0 0 0 0 1 0 1 1 1 0 1 1 0 1 1 0 1 1 0 0 0 1 0 0\n 1 1 1 1 0 1 0 1 1 0 1 1 1 1 0 0 0 1 1 1 1 1 0 1 1 0 0 1 1 1 1 0 1 0 1 0 0\n 0 0 0 1 0 0 1 0 0 1 1 1 0 1 0 1 1]\n0.15579710144927536\n{'accuracy': 0.8442028985507246, 'precision': 0.8442028985507246, 'recall': 0.8442028985507246, 'f1_score': 0.8442028985507245}\n"},"1":{"data":{"image/png":"e0d91f5642b5113ecbb0a9d0f390bdde0f7edae3","text/plain":"<Figure size 432x288 with 2 Axes>"},"exec_count":18,"metadata":{"needs_background":"light"},"output_type":"execute_result"}},"pos":15,"type":"cell"}
{"cell_type":"code","exec_count":180,"id":"e9fabb","input":"gs.best_score_","output":{"0":{"data":{"text/plain":"0.8651383841207714"},"exec_count":180,"output_type":"execute_result"}},"pos":46,"type":"cell"}
{"cell_type":"code","exec_count":185,"id":"ccb8d2","input":"total_squared_error = (np.sum((y_test - y_hat)**2))\nmean_squared_error = total_squared_error/len(y_test)\nprint(mean_squared_error)","output":{"0":{"name":"stdout","output_type":"stream","text":"0.08695652173913043\n"}},"pos":40,"type":"cell"}
{"cell_type":"code","exec_count":186,"id":"f5564d","input":"sns.heatmap(confusion_matrix(y_test, y_hat), annot=True, fmt='g')","output":{"0":{"data":{"text/plain":"<AxesSubplot:>"},"exec_count":186,"output_type":"execute_result"},"1":{"data":{"image/png":"89005b66e2968557a814a8b1386c4314efd82087","text/plain":"<Figure size 432x288 with 2 Axes>"},"exec_count":186,"metadata":{"needs_background":"light"},"output_type":"execute_result"}},"pos":41,"type":"cell"}
{"cell_type":"code","exec_count":19,"id":"01dd21","input":"import copy\nprint(x_train.shape)\n# ss=StandardScaler()\n# x_train=ss.fit_transform(x_train)\n# x_test=ss.fit_transform(x_test)\nCNN = tf.keras.Sequential([\n    tf.keras.layers.Flatten(input_shape=(11,1)),\n    tf.keras.layers.Dense(128, activation='relu', kernel_regularizer=tf.keras.regularizers.l1(0.005)),\n    tf.keras.layers.Dense(128, activation='relu', kernel_regularizer=tf.keras.regularizers.l1(0.005)),\n    tf.keras.layers.Dense(10)\n])\nCNN.compile(optimizer='adam',\n              loss=tf.keras.losses.SparseCategoricalCrossentropy(from_logits=True),\n              metrics=['accuracy'])\nCNN_history = CNN.fit(x_train, y_train, epochs=200, verbose = False)\nprediction = CNN.predict(x_test)\ny_hat = []\nfor i in range(0,len(prediction)):\n    prediction[i] = np.argmax(prediction[i])\nfor i in range(0,len(prediction)):\n    y_hat.append(int(prediction[i][0]))\nplt.plot(CNN_history.history['loss'])\nplt.title('Loss vs. epochs')\nplt.ylabel('Loss')\nplt.xlabel('Epoch')\nplt.legend(['Training', 'Validation'], loc='upper right')\nplt.show()\nprint(y_hat)\nprint(np.array(y_test))\ntest_loss, test_acc = CNN.evaluate(x_test,  y_test)","output":{"0":{"name":"stdout","output_type":"stream","text":"(642, 11)\n"},"1":{"name":"stderr","output_type":"stream","text":"2022-08-03 15:52:17.399972: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory\n2022-08-03 15:52:17.400025: W tensorflow/stream_executor/cuda/cuda_driver.cc:269] failed call to cuInit: UNKNOWN ERROR (303)\n2022-08-03 15:52:17.400050: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (754e23c69b95): /proc/driver/nvidia/version does not exist\n2022-08-03 15:52:17.401686: I tensorflow/core/platform/cpu_feature_guard.cc:193] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 AVX512F FMA\nTo enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.\n"},"2":{"name":"stdout","output_type":"stream","text":"\r1/9 [==>...........................] - ETA: 0s"},"3":{"name":"stdout","output_type":"stream","text":"\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r9/9 [==============================] - 0s 2ms/step\n"},"4":{"data":{"image/png":"d61674952506d478a7e27a6c974e065ae0020b93","text/plain":"<Figure size 432x288 with 1 Axes>"},"exec_count":19,"metadata":{"needs_background":"light"},"output_type":"execute_result"},"5":{"name":"stdout","output_type":"stream","text":"[1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0, 0, 0, 1, 1, 0, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 0, 1, 1, 0, 1, 1, 0, 0, 1, 1, 0, 1, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 0, 0, 1, 1, 1, 1, 1, 0, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 1, 0, 1, 0, 1, 0, 0, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 0, 0, 0, 1, 0, 1, 0, 1, 1, 0, 1, 0, 1, 0, 0, 1, 0, 0, 1, 0, 1, 1, 0, 0, 0, 1, 1, 0, 0, 0, 0, 1, 1, 0, 1, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 1, 1, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 0, 1, 0, 1, 1, 1, 0, 1, 0, 0, 0, 1, 0, 1, 1, 1, 1, 1, 0, 0, 1, 1, 0, 1, 1, 0, 1, 0, 0, 1, 0, 0, 0, 1, 0, 0, 1, 0, 1, 1, 1, 1, 0, 1, 0, 0, 1, 0, 1, 1, 0, 0, 1, 1, 0, 0, 0, 1, 1, 1, 0, 1, 0, 0, 1, 0, 1, 1, 1, 1, 0, 1, 0, 1, 1, 1, 1, 1, 0, 1, 1, 0, 0, 1, 1, 1, 1, 0, 1, 0, 1, 0, 0, 0, 0, 0, 1, 0, 0, 1, 0, 0, 1, 1, 1, 0, 1, 0, 1, 0]\n[1 1 1 0 1 1 1 0 0 1 1 0 0 0 1 1 1 1 1 1 0 1 1 1 0 1 1 1 0 0 0 1 1 0 1 1 0\n 1 1 0 0 1 1 0 1 0 0 0 0 0 1 1 1 1 1 1 0 1 0 0 0 1 0 0 0 1 1 1 1 0 1 1 1 1\n 1 0 0 1 0 0 1 1 1 1 0 0 1 0 1 1 0 0 0 1 1 0 1 1 1 0 1 0 0 1 0 1 0 0 0 1 1\n 1 0 1 0 0 1 0 1 1 1 1 0 1 1 1 1 1 1 0 0 0 1 0 0 0 0 1 1 0 1 1 1 1 0 1 0 0\n 0 1 0 1 0 0 1 1 0 1 0 0 1 0 1 1 1 0 0 1 0 1 1 0 0 1 0 0 0 1 0 1 1 1 1 1 1\n 0 1 1 0 1 1 0 1 0 0 1 0 0 0 0 0 0 1 0 1 1 1 0 1 1 0 1 1 0 1 1 0 0 0 1 0 0\n 1 1 1 1 0 1 0 1 1 0 1 1 1 1 0 0 0 1 1 1 1 1 0 1 1 0 0 1 1 1 1 0 1 0 1 0 0\n 0 0 0 1 0 0 1 0 0 1 1 1 0 1 0 1 1]\n"},"6":{"name":"stdout","output_type":"stream","text":"\r1/9 [==>...........................] - ETA: 1s - loss: 0.4982 - accuracy: 0.8125"},"7":{"name":"stdout","output_type":"stream","text":"\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r9/9 [==============================] - 0s 2ms/step - loss: 0.3753 - accuracy: 0.8514\n"}},"pos":17,"type":"cell"}
{"cell_type":"code","exec_count":22,"id":"8354b0","input":"tree_model = tree.DecisionTreeClassifier(max_depth = 54, min_samples_split = 33, min_samples_leaf= 11)\ntree_model.fit(x_train, y_train)\ny_hat = tree_model.predict(x_test)\nfig = plt.figure(figsize=(10,3))\ntree_plot = tree.plot_tree(tree_model, feature_names=input_columns.columns, filled=True, fontsize=8)\nacc = accuracy_score(y_test, y_hat)\nprec = precision_score(y_test, y_hat)\nrecall = recall_score(y_test, y_hat)\nf1 = f1_score(y_test, y_hat)\nscores['DTC_GRID'] = {'accuracy': acc, 'precision':prec, 'recall':recall, 'f1_score':f1}\nprint(scores['DTC_GRID'])\n\n\n","output":{"0":{"name":"stdout","output_type":"stream","text":"{'accuracy': 0.8623188405797102, 'precision': 0.8766233766233766, 'recall': 0.8766233766233766, 'f1_score': 0.8766233766233766}\n"},"1":{"data":{"image/png":"6032147860d02e47805db270272c68b4e3e9ba9f","text/plain":"<Figure size 720x216 with 1 Axes>"},"exec_count":22,"metadata":{"needs_background":"light"},"output_type":"execute_result"}},"pos":27,"scrolled":true,"type":"cell"}
{"cell_type":"code","exec_count":23,"id":"da3e60","input":"tree_model = tree.DecisionTreeClassifier()\ntree_model.fit(x_train, y_train)\ny_hat = tree_model.predict(x_test)\nfig = plt.figure(figsize=(25,20))\ntree_plot = tree.plot_tree(tree_model, feature_names=input_columns.columns, filled=True, fontsize=20)\nacc = accuracy_score(y_test, y_hat)\nprec = precision_score(y_test, y_hat)\nrecall = recall_score(y_test, y_hat)\nf1 = f1_score(y_test, y_hat)\nscores['DTC'] = {'accuracy': acc, 'precision':prec, 'recall':recall, 'f1_score':f1}\nprint(scores['DTC'])\n\n\n","output":{"0":{"name":"stdout","output_type":"stream","text":"{'accuracy': 0.8152173913043478, 'precision': 0.8601398601398601, 'recall': 0.7987012987012987, 'f1_score': 0.8282828282828283}\n"},"1":{"data":{"image/png":"e7345b3b529b36e115b5aa0f2ab5bdee68661b53","text/plain":"<Figure size 1800x1440 with 1 Axes>"},"exec_count":23,"metadata":{"needs_background":"light"},"output_type":"execute_result"}},"pos":28,"type":"cell"}
{"cell_type":"code","exec_count":26,"id":"cc713c","input":"scores.keys()","output":{"0":{"data":{"text/plain":"dict_keys(['metrics', 'Adaboost', 'knn_grid', 'knn', 'LOGISTICREGRESSION', 'mlp', 'CNN', 'DTC_GRID', 'DTC'])"},"exec_count":26,"output_type":"execute_result"}},"pos":31,"type":"cell"}
{"cell_type":"code","exec_count":27,"id":"33bee5","input":"param_grid = {'max_depth': range(1,160), 'min_samples_split': range(2, 160), 'min_samples_leaf': range(1, 160)}\ngs = RandomizedSearchCV(DecisionTreeClassifier(),param_grid, n_iter = 10000)\ngs.fit(x_train, y_train)\n\nrf_best = gs.best_estimator_\nrf_pred = rf_best.predict(x_test)\nacc = accuracy_score(y_test, y_hat)\nprec = precision_score(y_test, y_hat)\nrecall = recall_score(y_test, y_hat)\nf1 = f1_score(y_test, y_hat)\nscores['RF_Grid'] = {'accuracy': acc, 'precision':prec, 'recall':recall, 'f1_score':f1}\nprint(scores['RF_Grid'])","output":{"0":{"name":"stdout","output_type":"stream","text":"{'accuracy': 0.8152173913043478, 'precision': 0.8601398601398601, 'recall': 0.7987012987012987, 'f1_score': 0.8282828282828283}\n"}},"pos":32,"type":"cell"}
{"cell_type":"code","exec_count":28,"id":"ae8f5c","input":"#Random Forest Model\nrf_model = RFC()\nrf_model.fit(x_train, y_train)\ny_hat = rf_model.predict(x_test)\n\n\nacc = accuracy_score(y_test, y_hat)\nprec = precision_score(y_test, y_hat)\nrecall = recall_score(y_test, y_hat)\nf1 = f1_score(y_test, y_hat)\nscores['rf'] = {'accuracy': acc, 'precision':prec, 'recall':recall, 'f1_score':f1}\nprint(scores['rf'])\n","output":{"0":{"name":"stdout","output_type":"stream","text":"{'accuracy': 0.894927536231884, 'precision': 0.9032258064516129, 'recall': 0.9090909090909091, 'f1_score': 0.9061488673139159}\n"}},"pos":35,"type":"cell"}
{"cell_type":"code","exec_count":33,"id":"3acf5b","input":"mdl = svc()\nparam_grid = {\"C\": [.1, 1, 10, 100, 1000], 'gamma': [.1, 1, 10, 100, 1000], 'kernel': ['poly', 'linear', 'rbf', 'sigmoid']}\ngrid_search = GridSearchCV(mdl, param_grid = param_grid, cv = 5)\ngrid_search.fit(x_train, y_train)\nsvc_best = grid_search.best_estimator_\ny_pred = svc_best.predict(x_test)\nacc = accuracy_score(y_test, y_pred)\nprec = precision_score(y_test, y_pred)\nrecall = recall_score(y_test, y_pred)\nf1 = f1_score(y_test, y_pred)\nsns.heatmap(confusion_matrix(y_test, y_pred), annot=True, fmt='g')\nscores['SVC'] = {'accuracy': acc, 'precision':prec, 'recall':recall, 'f1_score':f1}\nprint(scores['SVC'])\n","output":{"0":{"name":"stdout","output_type":"stream","text":"{'accuracy': 0.8804347826086957, 'precision': 0.8853503184713376, 'recall': 0.9025974025974026, 'f1_score': 0.8938906752411576}\n"},"1":{"data":{"image/png":"5caebf784ede4fa31e80f14f0adc8fa6a803e260","text/plain":"<Figure size 432x288 with 2 Axes>"},"exec_count":33,"metadata":{"needs_background":"light"},"output_type":"execute_result"}},"pos":37,"type":"cell"}
{"cell_type":"code","exec_count":35,"id":"c15de1","input":"scores_df = pd.DataFrame(scores)","output":{"0":{"data":{"text/html":"<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>metrics</th>\n      <th>Adaboost</th>\n      <th>knn_grid</th>\n      <th>knn</th>\n      <th>LOGISTICREGRESSION</th>\n      <th>mlp</th>\n      <th>CNN</th>\n      <th>DTC_GRID</th>\n      <th>DTC</th>\n      <th>RF_Grid</th>\n      <th>rf</th>\n      <th>NAIVEBAYES</th>\n      <th>SVC</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>accuracy</th>\n      <td>accuracy</td>\n      <td>0.884058</td>\n      <td>0.862319</td>\n      <td>0.887681</td>\n      <td>0.855072</td>\n      <td>0.844203</td>\n      <td>0.865942</td>\n      <td>0.862319</td>\n      <td>0.815217</td>\n      <td>0.815217</td>\n      <td>0.894928</td>\n      <td>0.855072</td>\n      <td>0.880435</td>\n    </tr>\n    <tr>\n      <th>precision</th>\n      <td>precision</td>\n      <td>0.896104</td>\n      <td>0.886667</td>\n      <td>0.907285</td>\n      <td>0.895833</td>\n      <td>0.844203</td>\n      <td>0.882353</td>\n      <td>0.876623</td>\n      <td>0.860140</td>\n      <td>0.860140</td>\n      <td>0.903226</td>\n      <td>0.890411</td>\n      <td>0.885350</td>\n    </tr>\n    <tr>\n      <th>recall</th>\n      <td>recall</td>\n      <td>0.896104</td>\n      <td>0.863636</td>\n      <td>0.889610</td>\n      <td>0.837662</td>\n      <td>0.844203</td>\n      <td>0.876623</td>\n      <td>0.876623</td>\n      <td>0.798701</td>\n      <td>0.798701</td>\n      <td>0.909091</td>\n      <td>0.844156</td>\n      <td>0.902597</td>\n    </tr>\n    <tr>\n      <th>f1_score</th>\n      <td>f1_score</td>\n      <td>0.896104</td>\n      <td>0.875000</td>\n      <td>0.898361</td>\n      <td>0.865772</td>\n      <td>0.844203</td>\n      <td>0.879479</td>\n      <td>0.876623</td>\n      <td>0.828283</td>\n      <td>0.828283</td>\n      <td>0.906149</td>\n      <td>0.866667</td>\n      <td>0.893891</td>\n    </tr>\n  </tbody>\n</table>\n</div>","text/plain":"             metrics  Adaboost  knn_grid       knn  LOGISTICREGRESSION  \\\naccuracy    accuracy  0.884058  0.862319  0.887681            0.855072   \nprecision  precision  0.896104  0.886667  0.907285            0.895833   \nrecall        recall  0.896104  0.863636  0.889610            0.837662   \nf1_score    f1_score  0.896104  0.875000  0.898361            0.865772   \n\n                mlp       CNN  DTC_GRID       DTC   RF_Grid        rf  \\\naccuracy   0.844203  0.865942  0.862319  0.815217  0.815217  0.894928   \nprecision  0.844203  0.882353  0.876623  0.860140  0.860140  0.903226   \nrecall     0.844203  0.876623  0.876623  0.798701  0.798701  0.909091   \nf1_score   0.844203  0.879479  0.876623  0.828283  0.828283  0.906149   \n\n           NAIVEBAYES       SVC  \naccuracy     0.855072  0.880435  \nprecision    0.890411  0.885350  \nrecall       0.844156  0.902597  \nf1_score     0.866667  0.893891  "},"exec_count":35,"output_type":"execute_result"}},"pos":38,"type":"cell"}
{"cell_type":"code","exec_count":39,"id":"b5c8ab","input":"import plotly.graph_objects as go\n\nscores_df = pd.DataFrame(scores)\nscores_df = round(scores_df, 2)\n\ndata = []\nfor column in scores_df.columns:\n    data.append(scores_df[column].tolist())\n    \nfig = go.Figure(data=[go.Table(header=dict(values=list(scores_df.columns)),\n                 cells=dict(values=data))\n                     ])\nfig.show()\nfig.write_html(\"visualizations/scores.html\")\n","output":{"0":{"data":{"iframe":"adf2aabcc731388c8687165bb16c8e2684d93c2e"},"exec_count":39,"output_type":"execute_result"}},"pos":39,"scrolled":true,"type":"cell"}
{"cell_type":"code","exec_count":44,"id":"703339","input":"tree_model = tree.DecisionTreeClassifier(max_depth = 4, min_samples_split = 21)\ntree_model.fit(x_train, y_train)","output":{"0":{"data":{"text/html":"<style>#sk-container-id-10 {color: black;background-color: white;}#sk-container-id-10 pre{padding: 0;}#sk-container-id-10 div.sk-toggleable {background-color: white;}#sk-container-id-10 label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-container-id-10 label.sk-toggleable__label-arrow:before {content: \"▸\";float: left;margin-right: 0.25em;color: #696969;}#sk-container-id-10 label.sk-toggleable__label-arrow:hover:before {color: black;}#sk-container-id-10 div.sk-estimator:hover label.sk-toggleable__label-arrow:before {color: black;}#sk-container-id-10 div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-container-id-10 div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-container-id-10 input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-container-id-10 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {content: \"▾\";}#sk-container-id-10 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-10 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-10 input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-container-id-10 div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-container-id-10 div.sk-estimator:hover {background-color: #d4ebff;}#sk-container-id-10 div.sk-parallel-item::after {content: \"\";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-container-id-10 div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-10 div.sk-serial::before {content: \"\";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: 0;}#sk-container-id-10 div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;position: relative;}#sk-container-id-10 div.sk-item {position: relative;z-index: 1;}#sk-container-id-10 div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;position: relative;}#sk-container-id-10 div.sk-item::before, #sk-container-id-10 div.sk-parallel-item::before {content: \"\";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: -1;}#sk-container-id-10 div.sk-parallel-item {display: flex;flex-direction: column;z-index: 1;position: relative;background-color: white;}#sk-container-id-10 div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-container-id-10 div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-container-id-10 div.sk-parallel-item:only-child::after {width: 0;}#sk-container-id-10 div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;}#sk-container-id-10 div.sk-label label {font-family: monospace;font-weight: bold;display: inline-block;line-height: 1.2em;}#sk-container-id-10 div.sk-label-container {text-align: center;}#sk-container-id-10 div.sk-container {/* jupyter's `normalize.less` sets `[hidden] { display: none; }` but bootstrap.min.css set `[hidden] { display: none !important; }` so we also need the `!important` here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: https://github.com/scikit-learn/scikit-learn/issues/21755 */display: inline-block !important;position: relative;}#sk-container-id-10 div.sk-text-repr-fallback {display: none;}</style><div id=\"sk-container-id-10\" class=\"sk-top-container\"><div class=\"sk-text-repr-fallback\"><pre>DecisionTreeClassifier(max_depth=4, min_samples_split=21)</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br />On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class=\"sk-container\" hidden><div class=\"sk-item\"><div class=\"sk-estimator sk-toggleable\"><input class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-20\" type=\"checkbox\" checked><label for=\"sk-estimator-id-20\" class=\"sk-toggleable__label sk-toggleable__label-arrow\">DecisionTreeClassifier</label><div class=\"sk-toggleable__content\"><pre>DecisionTreeClassifier(max_depth=4, min_samples_split=21)</pre></div></div></div></div></div>","text/plain":"DecisionTreeClassifier(max_depth=4, min_samples_split=21)"},"exec_count":44,"output_type":"execute_result"}},"pos":21,"type":"cell"}
{"cell_type":"code","exec_count":45,"id":"b43abf","input":"y_hat = tree_model.predict(x_test)\ny_hat","output":{"0":{"data":{"text/plain":"array([1, 1, 1, 1, 1, 1, 1, 0, 0, 1, 1, 0, 0, 1, 1, 0, 0, 1, 0, 0, 1, 1,\n       1, 1, 1, 0, 0, 0, 0, 0, 1, 1, 0, 1, 0, 0, 0, 1, 0, 1, 1, 1, 1, 1,\n       1, 1, 1, 1, 0, 0, 1, 0, 1, 0, 1, 1, 1, 0, 1, 1, 0, 1, 1, 0, 1, 1,\n       1, 0, 0, 0, 1, 1, 0, 1, 1, 1, 1, 0, 0, 1, 1, 1, 1, 0, 0, 1, 0, 0,\n       1, 0, 0, 1, 0, 0, 0, 1, 0, 1, 0, 1, 1, 0, 0, 1, 0, 1, 0, 0, 0, 1,\n       1, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0, 1, 1, 0, 1, 0, 0, 1, 1, 1, 0, 1,\n       1, 1, 0, 0, 1, 1, 0, 1, 1, 1, 0, 0, 1, 1, 0, 1, 0, 1, 1, 0, 1, 1,\n       0, 1, 1, 1, 1, 0, 1, 0, 1, 1, 0, 0, 1, 1, 0, 1, 1, 0, 0, 1, 1, 1,\n       0, 1, 0, 0, 0, 0, 1, 1])"},"exec_count":45,"output_type":"execute_result"}},"pos":22,"type":"cell"}
{"cell_type":"code","exec_count":47,"id":"e0dd6f","input":"total_squared_error = (np.sum((y_test - y_hat)**2))\nmean_squared_error = total_squared_error/len(y_test)\nprint(mean_squared_error)","output":{"0":{"name":"stdout","output_type":"stream","text":"0.14130434782608695\n"}},"pos":23,"type":"cell"}
{"cell_type":"code","exec_count":49,"id":"5e024d","input":"\n","output":{"0":{"name":"stdout","output_type":"stream","text":"0.8586956521739131 0.8611111111111112 0.8942307692307693 0.8773584905660378\n{'accuracy': 0.8586956521739131, 'precision': 0.8611111111111112, 'recall': 0.8942307692307693, 'f1_score': 0.8773584905660378}\n"}},"pos":25,"type":"cell"}
{"cell_type":"code","exec_count":7,"id":"5d8820","input":"# #x is everything but heart disease\n# x = heart_df.loc[:, heart_df.columns != \"HeartDisease\"]\n# #y is heart disease\n# y = heart_df['HeartDisease']\n# # splits dataset; 80 percent train: 20 percent test\n# x_train, x_test, y_train, y_test= train_test_split(x, y, test_size= 0.2, random_state=0)\n# #scales down the x values\n# st_x= StandardScaler()\n# x_train= st_x.fit_transform(x_train)\n# x_test= st_x.transform(x_test)\n# classifier = LogisticRegression(random_state=0)\n# #Fits dataset\n# classifier.fit(x_train, y_train)\n# #gets predicted values\n# y_pred= classifier.predict(x_test)\n# #compares predictions to actual values\n# cm= confusion_matrix(y_pred, y_test)\n# print(cm)\n# \"\"\"total_squared_error = (np.sum((y_test - y_pred)**2))\n# mean_squared_error = total_squared_error/len(y_test)\n# print(mean_squared_error)\"\"\"\n# \"\"\"x_set, y_set = x_train, y_train  \n# x1, x2 = np.meshgrid(np.arange(start = x_set[:, 0].min() - 1, stop = x_set[:, 0].max() + 1, step  =0.01),  \n# np.arange(start = x_set[:, 1].min() - 1, stop = x_set[:, 1].max() + 1, step = 0.01))  \n# plt.contourf(x1, x2,x3,x4,x5,x6,x7,x8,x9,x10,x11 classifier.predict(np.array([x1.ravel(), x2.ravel()]).T).reshape(x1.shape),  \n# alpha = 0.75, cmap = ListedColormap(('purple','green' )))  \n# plt.xlim(x1.min(), x1.max())  \n# plt.ylim(x2.min(), x2.max())  \n# for i, j in enumerate(np.unique(y_set)):  \n#     plt.scatter(x_set[y_set == j, 0], x_set[y_set == j, 1],  \n#         c = ListedColormap(('purple', 'green'))(i), label = j)  \n# plt.title('Logistic Regression (Training set)')  \n# plt.xlabel('Age')  \n# plt.ylabel('Estimated Salary')  \n# plt.legend()  \n# plt.show()\"\"\" ","output":{"0":{"name":"stdout","output_type":"stream","text":"[[60 11]\n [17 96]]\n"},"1":{"data":{"text/plain":"\"x_set, y_set = x_train, y_train  \\nx1, x2 = np.meshgrid(np.arange(start = x_set[:, 0].min() - 1, stop = x_set[:, 0].max() + 1, step  =0.01),  \\nnp.arange(start = x_set[:, 1].min() - 1, stop = x_set[:, 1].max() + 1, step = 0.01))  \\nplt.contourf(x1, x2,x3,x4,x5,x6,x7,x8,x9,x10,x11 classifier.predict(np.array([x1.ravel(), x2.ravel()]).T).reshape(x1.shape),  \\nalpha = 0.75, cmap = ListedColormap(('purple','green' )))  \\nplt.xlim(x1.min(), x1.max())  \\nplt.ylim(x2.min(), x2.max())  \\nfor i, j in enumerate(np.unique(y_set)):  \\n    plt.scatter(x_set[y_set == j, 0], x_set[y_set == j, 1],  \\n        c = ListedColormap(('purple', 'green'))(i), label = j)  \\nplt.title('Logistic Regression (Training set)')  \\nplt.xlabel('Age')  \\nplt.ylabel('Estimated Salary')  \\nplt.legend()  \\nplt.show()\""},"exec_count":7,"output_type":"execute_result"}},"pos":16,"type":"cell"}
{"cell_type":"code","id":"9efe57","input":"","pos":2,"type":"cell"}
{"cell_type":"code","id":"b385ac","input":"","pos":1,"type":"cell"}
{"cell_type":"code","id":"bd0013","input":"","pos":0,"type":"cell"}
{"cell_type":"markdown","id":"5a504f","input":"A decision tree classifier model classifies data as it passes through the nodes in the tree and uses the gini index to determine where to split. In order to optimize the decision tree, I used cv and randomized cv to find the best hyperparameters. It has a max depth of 54, minimum samples split of 33, minimum samples leaf of 11, and accuracy of 0.84. \n","pos":30,"type":"cell"}
{"cell_type":"markdown","id":"5d595e","input":"**NOTE:** PLEASE save the scores to the score dictionary \n\nModels to try out:\n\n- Decision Tree \\(Emma\\)\n- Random Forest\n- NEURAL NETWORKS  Thomas\n- \n- Logistic Regression\n- \n- Naive Bayes \\(Jeffrey and Rhone\\)\n- Adaboost\n- Support vector classifier\n- \n- \n- Support vector classifier \n- KNN\n\n<u>**AlSO TRY OPTIMIZING THEM**</u>\n\nGrid Search CV\n\nEvaluation metrics:\n\n- F1 score\n- Accuracy\n- Recall\n- Precision\n- Confusion matrix\n\n","pos":7,"type":"cell"}
{"cell_type":"markdown","id":"603df8","input":"A random forest classifier is an ensemble of decision trees that work together to classify data. Each decision tree in the random forest individually classifies the data, and the outcome with the most votes becomes the final outcome of the model. I used randomized cv to find the best hyperparameters for the model. The max number of estimators is 67, the max depth is 90, and the model has an accuracy of 0.89, which is greater than an individual decision tree. \n\n","pos":42,"type":"cell"}
{"cell_type":"markdown","id":"81930b","input":"A neural network works through different layers. There is 1 input layer, 1 output layer, and a custom amount of hidden layers. The different nodes in the hidden layers are supposed to simulate how brains work. Basically, each node is a combination of the inputs in some way. My neural network also works with a validation split, which are a part of the training split. They make sure that the model is moving in the right direction when training. This neural network has 3 hidden layers with a 0.88 accuracy rating.\n","pos":19,"type":"cell"}
{"id":"1ca8ad","input":"","pos":23.5,"type":"cell"}
{"id":0,"time":1659626074701,"type":"user"}
{"last_load":1659621496784,"type":"file"}